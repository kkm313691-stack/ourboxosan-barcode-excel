<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<title>바코드 엑셀 생성</title>
</head>
<body>

<h2>바코드 엑셀 생성</h2>

<input id="name" placeholder="품명"><br>
<input id="exp" placeholder="소비기한"><br>
<input id="qty" placeholder="수량"><br>
<input id="barcode_qty" value="1"><br>
<input id="move_x" value="0"><br>

<button onclick="createExcel()">엑셀 생성</button>

<script>
function createExcel() {
  fetch("/create_excel", {

    method: "POST",
    headers: { "Content-Type": "application/json" },
    body: JSON.stringify({
      name: name.value,
      exp: exp.value,
      qty: qty.value,
      barcode_qty: barcode_qty.value,
      move_x: move_x.value
    })
  })
  .then(res => res.blob())
  .then(blob => {
    const a = document.createElement("a");
    a.href = URL.createObjectURL(blob);
    a.download = "바코드_라벨.xlsx";
    a.click();
  });
}
</script>

</body>
</html>
